# 服务器代码的生成

## 第一步：生成初步的服务器和网页代码

```
基于数据结构 cards/__base__.py 的设计，实现 server/ 下的服务器代码，服务器有 fastapi 构建的后端可以实时展示比赛情况的前端。你先实现初始的部分:

1.开启一局游戏，等待两个玩家的客户端发送 post 请求加入房间，服务器返回一个key，后续客户端需要使用key来控制出牌。双方均加入房间，并发送开始指令后游戏正式开始。
2.游戏开始时，载入 v0 和 v1 共 40 张卡，洗牌，发牌，并在前端展示当前的状态

参考 README.md
```

```
server/ 这个前端的代码有一些问题，玩家不应该看到对方的手牌
```

```
还是有 bug，左图是玩家一，右图是玩家二，只有玩家二显示了卡牌。另外，似乎两个玩家都被识别成了 fa44b99f-ecd
```

```
这里应该改成当前玩家的用户名 index.html,381-384 ，或者展示玩家1，玩家2 这种
```

```
用户指出host应该能看到双方玩家的卡牌，而不是都不展示。我需要检查当前的逻辑，然后修改代码让host（房主）能够看到所有玩家的手牌。
```

**切换不同 prompt 进行了多次尝试，均失败了！模型无法识别出 host 这个角色，导致无法修改代码；会修改成 玩家1 同时为 host ，能看到对方卡牌等错误的情况**

下面的方法类似于 CoT

```
重新梳理一下现在的服务器代码，是否有三个角色，

1. 点击”创建房间“后，当前的界面表示服务器后台

2. 第一个输入房间号，并且点击”加入“房间的用户，表示玩家1

2. 第二个输入房间号，并且点击”加入“房间的用户，表示玩家2
```

```
修改”创建房间者“的前端显示逻辑，使他可以看到双方玩家的手牌
```

```
把已经开发的内容写到 server/README.md 中
```

## 第二步：生成自动化的玩家

```
main.py README.md 现在帮我编写两个 Python 的玩家模拟程序，可以通过输入房间号连接到已有的房间中，然后会执行”确认“，然后依次执行”出牌“
```

```
players/test_bots.py 修改测试的代码，改为输入房间 id 后开始测试
```


```
我刚刚进行了测试，第一个玩家加入了，但没有准备
```


```
player_bot.py main.py 现在请编写每个回合*准备阶段* 的代码，并进行测试
```


```
1. 增加出牌阶段的代码，player_bot.py 采取随机出牌的策略，每次等5s再行动。服务端则每个回合等待最多 10s 客户端的响应。
2. 实现普通牌的结算，先不实现连击卡和反击卡。
```


```
1. 为了方便测试，目前从 main.py 启动时，只加载普通卡牌进入牌库
2. 貌似目前只有第一个玩家执行了第一个操作，请继续实现后续操作
```

```
1. 为了进行测试，把牌库所有的牌都换成”刻舟求剑“
2. 实现”刻舟求剑”对应的特殊效果
3. 假设玩家能说出该成语的含义，并给出典故
```

```
注释掉全部初始化为 “刻舟求剑" 的代码，换成 ”掩耳盗铃“ ，实现其功能并进行测试
```